{
  "entities": {
    "Customer": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Customer",
      "type": "object",
      "description": "Represents a customer profile.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Customer entity."
        },
        "aadhaarNumber": {
          "type": "string",
          "description": "Aadhaar number of the customer (encrypted)."
        },
        "panNumber": {
          "type": "string",
          "description": "PAN number of the customer (encrypted)."
        },
        "passportDetails": {
          "type": "string",
          "description": "Passport details of the customer (encrypted)."
        },
        "name": {
          "type": "string",
          "description": "Name of the customer."
        }
      },
      "required": [
        "id",
        "name"
      ]
    },
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task to be performed.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Task entity."
        },
        "customerId": {
          "type": "string",
          "description": "Reference to Customer. (Relationship: Customer 1:N Task)"
        },
        "assignedTo": {
          "type": "string",
          "description": "Reference to Employee. (Relationship: Employee 1:N Task).  Staff member assigned to the task."
        },
        "priority": {
          "type": "string",
          "description": "Priority level of the task (High, Medium, Low)."
        },
        "creationDate": {
          "type": "string",
          "description": "Date the task was created.",
          "format": "date-time"
        },
        "resolutionDate": {
          "type": "string",
          "description": "Date the task was resolved.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Description of the task."
        }
      },
      "required": [
        "id",
        "customerId",
        "assignedTo",
        "priority",
        "creationDate"
      ]
    },
    "Invoice": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Invoice",
      "type": "object",
      "description": "Represents an invoice.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Invoice entity."
        },
        "invoiceNumber": {
          "type": "string",
          "description": "Invoice number."
        },
        "customerName": {
          "type": "string",
          "description": "Name of the customer on the invoice."
        },
        "date": {
          "type": "string",
          "description": "Date of the invoice.",
          "format": "date-time"
        },
        "aadhaarNumber": {
          "type": "string",
          "description": "Aadhaar number extracted from the invoice (if available)."
        }
      },
      "required": [
        "id",
        "customerName",
        "date"
      ]
    },
    "Employee": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Employee",
      "type": "object",
      "description": "Represents an employee account.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Employee entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the employee."
        },
        "email": {
          "type": "string",
          "description": "Email address of the employee.",
          "format": "email"
        },
        "skills": {
          "type": "array",
          "description": "Skills possessed by the employee.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name",
        "email"
      ]
    },
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project and allows grouping of tasks and invoices.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Project entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the project."
        },
        "description": {
          "type": "string",
          "description": "Description of the project."
        },
        "taskIds": {
          "type": "array",
          "description": "References to Tasks. (Relationship: Project 1:N Task)",
          "items": {
            "type": "string"
          }
        },
        "invoiceIds": {
          "type": "array",
          "description": "References to Invoices. (Relationship: Project 1:N Invoice)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "name"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/customers/{customerId}",
        "definition": {
          "entityName": "Customer",
          "schema": {
            "$ref": "#/backend/entities/Customer"
          },
          "description": "Stores customer profiles.  Customer `id` is used as the document ID.",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier of the customer."
            }
          ]
        }
      },
      {
        "path": "/employees/{employeeId}",
        "definition": {
          "entityName": "Employee",
          "schema": {
            "$ref": "#/backend/entities/Employee"
          },
          "description": "Stores employee profiles. Employee `id` is used as the document ID.",
          "params": [
            {
              "name": "employeeId",
              "description": "The unique identifier of the employee."
            }
          ]
        }
      },
      {
        "path": "/customers/{customerId}/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores tasks associated with a customer. Includes denormalized `customerId` and `assignedTo` for authorization independence. Task `id` is used as the document ID.",
          "params": [
            {
              "name": "customerId",
              "description": "The unique identifier of the customer."
            },
            {
              "name": "taskId",
              "description": "The unique identifier of the task."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}",
        "definition": {
          "entityName": "Project",
          "schema": {
            "$ref": "#/backend/entities/Project"
          },
          "description": "Stores project details. Project `id` is used as the document ID.",
          "params": [
            {
              "name": "projectId",
              "description": "The unique identifier of the project."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores tasks associated with a project. Includes denormalized `customerId` and `assignedTo` for authorization independence.  Task `id` is used as the document ID.",
          "params": [
            {
              "name": "projectId",
              "description": "The unique identifier of the project."
            },
            {
              "name": "taskId",
              "description": "The unique identifier of the task."
            }
          ]
        }
      },
      {
        "path": "/projects/{projectId}/invoices/{invoiceId}",
        "definition": {
          "entityName": "Invoice",
          "schema": {
            "$ref": "#/backend/entities/Invoice"
          },
          "description": "Stores invoices associated with a project. Invoice `id` is used as the document ID.",
          "params": [
            {
              "name": "projectId",
              "description": "The unique identifier of the project."
            },
            {
              "name": "invoiceId",
              "description": "The unique identifier of the invoice."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to ensure Authorization Independence, support required QAPs (Queries are not Filters), and maintain data integrity. It leverages structural segregation and explicit access modeling. Since projects are top-level entities, they are stored in a root collection. Customers have a 1:N relationship with tasks, so tasks are stored in a subcollection. Similarly, Projects have a 1:N relationship with tasks, so tasks are stored in a subcollection.  For Authorization Independence, the `customerId` and `assignedTo` fields on `Task` documents eliminate the need for `get()` calls to `Customer` or `Employee` documents.  The structure separates concerns, placing user-owned resources under their respective user documents and collaborative resources in top-level collections."
  }
}